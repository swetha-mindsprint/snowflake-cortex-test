name: GL_TOTAL
description: This semantic view is to generate trial balance of an entity. This Semantic model can alternatively refer as Trial Balance as well.
tables:
  - name: DM_TT_GL_TOTALS_BY_MONTH
    description: GL Total by Month
    base_table:
      database: DB_DW_PRD
      schema: RPT_FINANCE
      table: DM_TT_GL_TOTALS_BY_MONTH
    dimensions:
      - name: ACCOUNT_NUMBER
        synonyms:
          - Account
          - Account Number
          - GL
          - GL Account
        expr: '"Account Number"'
        data_type: VARCHAR(128)
      - name: AUDIT_PACK_DESCRIPTION
        synonyms:
          - AP description
        expr: '"Audit Pack Description"'
        data_type: VARCHAR(60)
      - name: BS_PL_ACCOUNT_TYPE
        synonyms:
          - Balance sheet or Profit & Loss
          - Balance sheet or Profit and Loss
          - BS or P&L
        expr: '"BS/PL Account Type"'
        data_type: VARCHAR(3)
      - name: BU_NAME
        expr: '"BU Name"'
        data_type: VARCHAR(256)
      - name: BUSINESS_AREA
        description: Business Area
        expr: '"Business Area"'
        data_type: VARCHAR(128)
      - name: BUSINESS_AREA_DESCRIPTION
        expr: '"Business Area Name"'
        data_type: VARCHAR(30)
      - name: COMPANY_CODE
        synonyms:
          - Company
          - Company Code
        expr: '"Company Code"'
        data_type: VARCHAR(128)
      - name: COMPANY_NAME
        expr: '"Company Name"'
        data_type: VARCHAR(25)
      - name: GL_DESCRIPTION
        expr: '"GL description"'
        data_type: VARCHAR(20)
      - name: GL_LONG_DESCRIPTION
        expr: '"GL Long Description"'
        data_type: VARCHAR(50)
      - name: LEDGER
        expr: '"Ledger"'
        data_type: VARCHAR(128)
      - name: LOCAL_CURRENCY
        expr: '"Local Currency"'
        data_type: VARCHAR(128)
      - name: MIS_DESCRIPTION
        expr: '"MIS Description"'
        data_type: VARCHAR(60)
      - name: MONTH
        synonyms:
          - Period
          - Posting Period
        expr: '"Month"'
        data_type: VARCHAR(128)
      - name: PROFIT_CENTER
        expr: '"Profit Center"'
        data_type: VARCHAR(128)
      - name: PROFIT_CENTER_NAME
        expr: '"Profit Center Name"'
        data_type: VARCHAR(20)
      - name: RECORD_TYPE
        expr: '"Record Type"'
        data_type: VARCHAR(128)
      - name: TRANSACTION_CURRENCY
        expr: '"Transaction Currency"'
        data_type: VARCHAR(128)
      - name: YEAR
        synonyms:
          - Financial Year
          - Fiscal year
        expr: '"Year"'
        data_type: VARCHAR(4)
        sample_values:
          - '2021'
          - '2017'
          - '2022'
    facts:
      - name: GC_AMOUNT
        synonyms:
          - GC
          - Group Currency amount
          - USD Balance
        expr: '"GC Amount"'
        data_type: FLOAT
        access_modifier: public_access
        default_aggregation: 1
      - name: LC_AMOUNT
        synonyms:
          - LC Balance
          - Local Currency Balance
        expr: '"LC Amount"'
        data_type: FLOAT
        access_modifier: public_access
        default_aggregation: 1
      - name: TC_AMOUNT
        synonyms:
          - TC Balance
          - Transaction currency Balance
        expr: '"TC Amount"'
        data_type: FLOAT
        access_modifier: public_access
        default_aggregation: 1
    filters:
      - name: BALANCE_SHEET
        synonyms:
          - BS
        expr: '"BS/PL Account Type" = ''BS'''
      - name: CFM
        synonyms:
          - Crown Flour Mills
        description: ''
        expr: '"Company Code" = ''NG12'''
      - name: CLA_TRIAL_BALANCE_SG03
        synonyms:
          - CLA Singapore
          - CLA TB SG03
          - SG03 CLA
        description: Use to generate CLA trial balance for SG03 by selecting E1 ledger and SG03 company code.
        expr: '"Ledger" = ''E1'' AND "Company Code" = ''SG03'''
      - name: CORPORATE
        synonyms:
          - Corporate Trial balance
          - Holding
          - Singapore
          - Singapore Trial balance
        description: Restrict Corporate
        expr: '"Company Code" in (''SG03'',''SGG5'',''SGG4'')'
      - name: OGAPL
        synonyms:
          - Olam Agri Pte
          - Olam Agri Pte Ltd
        description: Restrict result for OGAPL company code
        expr: '"Company Code"=''SG03'''
      - name: ONL
        synonyms:
          - Olam Nigeria
          - Olam Nigeria Limited
        description: Restrict the result for ONL company code
        expr: '"Company Code"=''NG10'''
      - name: Origin_TB
        synonyms:
          - Origin
          - Origin TB
          - Subsidiary
        description: Filter is to restrict result for Origin
        expr: '"Company Code" not in (''SG03'',''SGG5'',''SGG4'')'
      - name: Profit_And_Loss
        synonyms:
          - P&L
          - PNL
          - Profit & Loss
        expr: '"BS/PL Account Type" = ''PL'''
      - name: SINGAPORE_FINANCIAL_TRIAL_BALANCE
        synonyms:
          - Financial TB
          - SFRS TB
          - SG03 SFRS
          - Singapore SFRS
        description: Use to generate SFRS trial balance for SG03 by selecting appropriate ledgers (0L and E1) and combining SG03 and SGG4 company codes.
        expr: '"Ledger" IN (''0L'', ''E1'') AND "Company Code" IN (''SG03'', ''SGG4'')'
verified_queries:
  - name: Generate September 2025 Audit Pack Trial balance for SG03.
    question: Generate September 2025 Audit Pack Trial balance for SG03.
    sql: |-
      SELECT
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
        "Transaction Currency",
        SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
        "Local Currency",
        SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
        "Audit Pack Description",
        "MIS Description"
      FROM
        DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
        "Year" = '2025'
        AND "Ledger" in ('0L', 'E1')
        AND "Company Code" in ('SG03', 'SGG4')
        AND TO_NUMBER("Month") <= 09
        AND "Record Type" = '0'
      GROUP BY
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        "Transaction Currency",
        "Local Currency",
        "Audit Pack Reporting",
        "Audit Pack Description",
        "MIS Reporting",
        "MIS Description"
      ORDER BY
        "Company Code",
        "Account Number",
        "Profit Center",
        "Business Area";
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767349523
  - name: Generate December 2025 CLA Trial balance for SG03.
    question: Generate December 2025 CLA Trial balance for SG03.
    sql: |-
      SELECT
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
          "Transaction Currency",
          SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
          "Local Currency",
          SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
          "Audit Pack Reporting",
          "Audit Pack Description",
          "MIS Reporting",
          "MIS Description"
      FROM DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
          "Year" = '2025'
          AND "Ledger" = 'E1'
          AND "Company Code" = 'SG03'
          AND TO_NUMBER("Month") <= 12
          AND "Record Type" = '0'
      GROUP BY
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          "Transaction Currency",
          "Local Currency",
          "Audit Pack Reporting",
          "Audit Pack Description",
          "MIS Reporting",
          "MIS Description"
      ORDER BY
          "Company Code",
          "Account Number",
          "Profit Center",
          "Business Area";
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767347940
  - name: Generate March 2024 FTM Trial balance for Olam Agri Ghana.
    question: Generate March 2024 FTM Trial balance for Olam Agri Ghana.
    sql: |-
      SELECT
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
          "Transaction Currency",
          SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
          "Local Currency",
          SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
          "Audit Pack Description",
          "MIS Description"
      FROM DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
          "Year" = '2024'
          AND "Ledger" in ( '0L')
          AND "Company Name" like '%Olam Agri Ghana%'
          AND TO_NUMBER("Month") = 03
          AND "Record Type" = '0'
      GROUP BY
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          "Transaction Currency",
          "Local Currency",
          "Audit Pack Description",
          "MIS Description"
      ORDER BY
          "Company Code",
          "Account Number",
          "Profit Center",
          "Business Area";
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767348466
  - name: Generate December 2025 YTD TB for CFM.
    question: Generate December 2025 YTD TB for CFM.
    sql: |-
      SELECT
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
        "Transaction Currency",
        SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
        "Local Currency",
        SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
        "Audit Pack Description",
        "MIS Description"
      FROM
        DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
        "Year" = '2025'
        AND "Ledger" in ('L3')
        AND "Company Code" = 'NG12'
        AND TO_NUMBER("Month") <= 12
        AND "Record Type" = '0'
      GROUP BY
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        "Transaction Currency",
        "Local Currency",
        "Audit Pack Description",
        "MIS Description"
      ORDER BY
        "Company Code",
        "Account Number",
        "Profit Center",
        "Business Area";
    use_as_onboarding_question: false
    verified_by: Rosalin Nayak
    verified_at: 1767349832
  - name: Generate March 2025 PRO TB.
    question: Generate March 2025 PRO TB.
    sql: |-
      SELECT
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
        "Transaction Currency",
        SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
        "Local Currency",
        SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
        "Audit Pack Description",
        "MIS Description"
      FROM
        DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
        "Year" = '2025'
        AND "Ledger" in ('0L')
        AND "Company Code" = 'SGG5'
        AND TO_NUMBER("Month") <= 03
        AND "Record Type" = '0'
      GROUP BY
        "Company Code",
        "Company Name",
        "Account Number",
        "GL description",
        "Profit Center",
        "Profit Center Name",
        "Business Area",
        "Business Area Name",
        "BU Name",
        "Transaction Currency",
        "Local Currency",
        "Audit Pack Description",
        "MIS Description"
      ORDER BY
        "Company Code",
        "Account Number",
        "Profit Center",
        "Business Area";
    use_as_onboarding_question: false
    verified_by: Rosalin Nayak
    verified_at: 1767349843
  - name: Generate 2024 Special period Trial balance for ONL.
    question: Generate 2024 Special period Trial balance for ONL.
    sql: |-
      SELECT
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
          "Transaction Currency",
          SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
          "Local Currency",
          SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
          "Audit Pack Description",
          "MIS Description"
      FROM DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
          "Year" = '2024'
          AND "Ledger" in ( 'L3')
          AND "Company Code" = 'NG10'
          AND TO_NUMBER("Month") in (13,14,15,16)
          AND "Record Type" = '0'
      GROUP BY
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
          "Profit Center",
          "Profit Center Name",
          "Business Area",
          "Business Area Name",
          "BU Name",
          "Transaction Currency",
          "Local Currency",
          "Audit Pack Description",
          "MIS Description"
      ORDER BY
          "Company Code",
          "Account Number",
          "Profit Center",
          "Business Area";
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767349777
  - name: What is the balance of GL account 120001 as on June 2025 in Company code SG03?
    question: What is the balance of GL account 120001 as on June 2025 in Company code SG03?
    sql: |-
      SELECT
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
         // "Profit Center",
          //"Profit Center Name",
          //"Business Area",
          //"Business Area Name",
          //"BU Name",
          SUM(COALESCE("TC Amount", 0)) AS total_tc_amount,
          "Transaction Currency",
          SUM(COALESCE("LC Amount", 0)) AS total_lc_amount,
          "Local Currency",
          SUM(COALESCE("GC Amount", 0)) AS total_gc_amount,
          "Audit Pack Description",
          "MIS Description"
      FROM DB_DW_PRD.RPT_FINANCE.DM_TT_GL_TOTALS_BY_MONTH
      WHERE
          "Year" = '2025'
          AND "Ledger" in ( '0L')
          AND "Company Code" = 'SG03'
          AND TO_NUMBER("Month") <= 06
          AND "Record Type" = '0'
          And "Account Number" = '0000120001'
      GROUP BY
          "Company Code",
          "Company Name",
          "Account Number",
          "GL description",
         // "Profit Center",
          //"Profit Center Name",
          //"Business Area",
          //"Business Area Name",
          //"BU Name",
          "Transaction Currency",
          "Local Currency",
          "Audit Pack Description",
          "MIS Description"
      ORDER BY
          "Company Code",
          "Account Number";
          //"Profit Center",
          //"Business Area";
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767352035
  - name: What is the balance of GL account 120001 as on August 2025 in GH00
    question: What is the balance of GL account 120001 as on August 2025 in GH00
    sql: |-
      SELECT
        account_number,
        company_code,
        ledger,
        year,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        account_number = '0000120001'
        AND company_code = 'GH00'
        AND ledger = '0L'
        AND year = '2025'
        AND month IN (
          '00',
          '01',
          '02',
          '03',
          '04',
          '05',
          '06',
          '07',
          '08'
        )
        and Record_type = '0'
      GROUP BY
        account_number,
        company_code,
        ledger,
        year;
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767353746
  - name: Generate December 2025 YTB TB for CFM
    question: Generate December 2025 YTB TB for CFM
    sql: |-
      SELECT
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        company_code = 'NG12'
        AND year = '2025'
        AND (
          month <= '12'
          OR month IN ('13', '14', '15', '16')
        )
        AND ledger = 'L3'
        and Record_type = '0'
      GROUP BY
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency
      ORDER BY
        account_number
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767353794
  - name: Show me P&L total USD for GH00 company code as on Dec 2025
    question: Show me P&L total USD for GH00 company code as on Dec 2025
    sql: |-
      SELECT
        company_code,
        ledger,
        year,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        bs_pl_account_type = 'PL'
        AND company_code = 'GH00'
        AND ledger = '0L' // AND Record_type = '0'
        AND year = '2025'
        AND month IN (
          '00',
          '01',
          '02',
          '03',
          '04',
          '05',
          '06',
          '07',
          '08',
          '09',
          '10',
          '11',
          '12'
        )
        and Record_type = '0'
      GROUP BY
        company_code,
        ledger,
        year
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767353812
  - name: Show me special period trial balance of 2024 for CFM
    question: Show me special period trial balance of 2022 for CFM
    sql: |-
      SELECT
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        company_code = 'NG12'
        AND year = '2022'
        AND month IN ('13', '14', '15', '16')
        AND ledger = 'L3'
        AND record_type = '0'
      GROUP BY
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency
      ORDER BY
        account_number
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767353935
  - name: Generate CLA TB for September 2025
    question: Generate CLA TB for September 2025
    sql: |-
      SELECT
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        company_code = 'SG03'
        AND year = '2025'
        AND month <= '09'
        AND ledger = 'E1'
        AND record_type = '0'
      GROUP BY
        account_number,
        gl_description,
        gl_long_description,
        audit_pack_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        local_currency,
        transaction_currency
      ORDER BY
        account_number
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767354149
  - name: What is the movement of P&L USD balance between 2024 March YTD and 2025 March YTD for CFM
    question: What is the movement of P&L USD balance between 2024 March YTD and 2025 March YTD for CFM
    sql: |-
      WITH ytd_2024 AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_2024
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          bs_pl_account_type = 'PL'
          AND company_code = 'NG12'
          AND year = '2024'
          AND month IN ('00', '01', '02', '03')
          AND ledger = 'L3'
          AND record_type = '0'
      ),
      ytd_2025 AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_2025
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          bs_pl_account_type = 'PL'
          AND company_code = 'NG12'
          AND year = '2025'
          AND month IN ('00', '01', '02', '03')
          AND ledger = 'L3'
          AND record_type = '0'
      )
      SELECT
        '2024 March YTD' AS period_2024,
        gc_amount_2024,
        '2025 March YTD' AS period_2025,
        gc_amount_2025,
        ROUND(gc_amount_2025 - gc_amount_2024, 2) AS absolute_change,
        ROUND(
          (gc_amount_2025 - gc_amount_2024) / NULLIF(NULLIF(gc_amount_2024, 0), 0),
          4
        ) AS percentage_change
      FROM
        ytd_2024
        CROSS JOIN ytd_2025
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767355447
  - name: Generate May 2025 FTM TB of CM13
    question: Generate May 2025 FTM TB of CM10
    sql: |-
      SELECT
        account_number,
        gl_long_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        audit_pack_description,
        local_currency,
        transaction_currency,
        ROUND(SUM(tc_amount), 2) AS tc_amount,
        ROUND(SUM(lc_amount), 2) AS lc_amount,
        ROUND(SUM(gc_amount), 2) AS gc_amount
      FROM
        dm_tt_gl_totals_by_month
      WHERE
        company_code = 'CM10'
        AND year = '2025'
        AND month = '05'
        AND ledger = '0L'
        AND record_type = '0'
      GROUP BY
        account_number,
        gl_description,
        gl_long_description,
        bs_pl_account_type,
        profit_center,
        profit_center_name,
        business_area,
        business_area_description,
        mis_description,
        audit_pack_description,
        local_currency,
        transaction_currency
      ORDER BY
        account_number
    use_as_onboarding_question: true
    verified_by: Rosalin Nayak
    verified_at: 1767357770
  - name: Show me the movement of Trade debtors from Last month to current month for OGAPL
    question: Show me the movement of assets between 2025 December month YTD and November month YTD for OGAPL.
    sql: |-
      WITH ytd_december AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_december
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          bs_pl_account_type = 'BS'
          AND company_code = 'SG03'
          AND year = '2025'
          AND month IN (
            '00',
            '01',
            '02',
            '03',
            '04',
            '05',
            '06',
            '07',
            '08',
            '09',
            '10',
            '11',
            '12'
          )
          AND ledger IN ('0L', 'E1')
          AND record_type = '0'
      ),
      ytd_november AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_november
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          bs_pl_account_type = 'BS'
          AND company_code = 'SG03'
          AND year = '2025'
          AND month IN (
            '00',
            '01',
            '02',
            '03',
            '04',
            '05',
            '06',
            '07',
            '08',
            '09',
            '10',
            '11'
          )
          AND ledger IN ('0L', 'E1')
          AND record_type = '0'
      )
      SELECT
        '2025 December YTD' AS period_december,
        gc_amount_december,
        '2025 November YTD' AS period_november,
        gc_amount_november,
        ROUND(gc_amount_december - gc_amount_november, 2) AS absolute_change,
        ROUND(
          (gc_amount_december - gc_amount_november) / NULLIF(NULLIF(gc_amount_november, 0), 0),
          4
        ) AS percentage_change
      FROM
        ytd_december
        CROSS JOIN ytd_november
    use_as_onboarding_question: false
    verified_by: Rosalin Nayak
    verified_at: 1767359677
  - name: Show me the movement of Trade debtors from Last month to current month for OGAPL
    question: Show me the movement of Trade debtors from Last month to current month for OGAPL
    sql: |-
      WITH last_month AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_last
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          gl_description LIKE '%Trade debtor%'
          AND company_code = 'SG03'
          AND year = CAST(
            DATE_PART('YEAR', DATEADD(MONTH, -1, CURRENT_DATE)) AS TEXT
          )
          AND month = LPAD(
            CAST(
              DATE_PART('MONTH', DATEADD(MONTH, -1, CURRENT_DATE)) AS TEXT
            ),
            2,
            '0'
          )
          AND ledger = '0L'
          AND record_type = '0'
      ),
      current_month AS (
        SELECT
          ROUND(SUM(gc_amount), 2) AS gc_amount_current
        FROM
          dm_tt_gl_totals_by_month
        WHERE
          gl_description LIKE '%Trade debtor%'
          AND company_code = 'SG03'
          AND year = CAST(DATE_PART('YEAR', CURRENT_DATE) AS TEXT)
          AND month = LPAD(
            CAST(DATE_PART('MONTH', CURRENT_DATE) AS TEXT),
            2,
            '0'
          )
          AND ledger = '0L'
          AND record_type = '0'
      )
      SELECT
        'Last Month' AS period_last,
        gc_amount_last,
        'Current Month' AS period_current,
        gc_amount_current,
        ROUND(gc_amount_current - gc_amount_last, 2) AS absolute_change,
        ROUND(
          (gc_amount_current - gc_amount_last) / NULLIF(NULLIF(gc_amount_last, 0), 0),
          4
        ) AS percentage_change
      FROM
        last_month
        CROSS JOIN current_month
    use_as_onboarding_question: false
    verified_by: Rosalin Nayak
    verified_at: 1767360034
module_custom_instructions:
  sql_generation: |-
    ### General Instructions
    -Always Select Record_Type = 0
    - When the user specifies a year as a number (e.g., 2025), compare it to the Year dimension as text
    (e.g., '2025  compare it to the Year dimension as text (e.g., '2025').
    ### Selection of ledger
    - Select L3 ledger for Nigeria entities
    - For SFRS Trial balance of SG03 company code select 0L and E1 ledger
    - For CLA Trial balance of SG03 company code select E1 ledger
    - 0L ledger for all the other entities
    - For Management TB, always select 0L ledger
    ### Instruction on Company codes
    - For SFRS Trial balance of SG03, combine Trial balance of SG03 and SGG4 company codes
    - For PRO books Trial balance, select company code SGG5 company code
    ### Period (Month) instruction
    - For Trial balance of Special period, Select Month 13 to 16
    - Select all Months, if user does not specify to exclude Special period
    ### FTM Vs. YTD instruction
    - For FTM trial balance provide the trial balance for the Specific month asked by user
    - For YTD trial balance select all the months <= the month asked by user
    ### Handling decimals
    -Always Round off TC amount, LC amount and GC amount columns up to 2 decimal places
    ### Handling Corporate and Origin or Subsidiary
    - Select Company code in (SG03, SGG4, SGG5) for Corporate
    - Select Company code not in (SG03, SGG4, SGG5) for Origin or Subsidiary
    ### Columns in output or result
    - Try to show the columns in the output in the below sequence-
           -Company code
           -Company name
           -Account number
           -GL Description
           -Transaction Currency
           -Transaction Currency balance
           -Local currency
           -LC balance
           -GC balance
           -BU name
           -PC
           -PC Name
           -Business Area
           -Business Area name
           -AP description
           -MIS description
    ### Sorting in the output or result
     - Sort the result by ascending order
         -Company code
         -Account number

    For trial balance queries, always aggregate amount columns using SUM() and include appropriate GROUP BY clauses with all non-aggregated columns.
